"use strict";(self.webpackChunkgrafana_metricsdrilldown_app=self.webpackChunkgrafana_metricsdrilldown_app||[]).push([[768],{2993:(e,t,n)=>{n.d(t,{E:()=>s});var r=n(6089),a=n(2007),o=n(5959),c=n.n(o),i=n(1159),l=n(6503);function s({error:e}){const t=(0,a.useStyles2)(m),n=(0,i.useNavigate)(),{pathname:r,search:s}=(0,i.useLocation)(),u=(0,o.useCallback)(()=>{const e=new URLSearchParams(s),t=new URLSearchParams;["from","to","timezone"].filter(t=>e.has(t)).forEach(n=>t.set(n,e.get(n))),n({pathname:r,search:t.toString()}),window.location.reload()},[n,r,s]),[d,p]=(0,o.useState)(!1);return c().createElement("div",{className:t.container},c().createElement(l._,{severity:"error",title:"Fatal error!",error:e,errorContext:{handheldBy:"React error boundary"},message:c().createElement(c().Fragment,null,c().createElement("p",{className:t.message},"Please"," ",c().createElement(a.TextLink,{href:"#",onClick:u},"try reloading the page")," ","or, if the problem persists, contact your organization admin. Sorry for the inconvenience."),c().createElement("p",null,c().createElement(a.Collapse,{className:t.callStack,label:"View stack trace",isOpen:d,onToggle:()=>p(!d)},c().createElement("pre",null,c().createElement("code",null,e.stack)))))}))}function m(e){return{container:(0,r.css)({margin:e.spacing(2)}),message:(0,r.css)({margin:e.spacing(2,0,1,0)}),callStack:(0,r.css)({backgroundColor:"transparent",border:"0 none","& button":(0,r.css)({paddingLeft:e.spacing(1.5)}),"& button:focus":(0,r.css)({outline:"none",boxShadow:"none"}),"& button > svg":(0,r.css)({marginLeft:e.spacing(-2),marginRight:e.spacing(.5)}),'& [class$="collapse__loader"]':(0,r.css)({display:"none"})})}}},4768:(e,t,n)=>{n.r(t),n.d(t,{default:()=>b});var r=n(8531),a=n(5959),o=n.n(a),c=n(2993),i=n(8732),l=n(1522),s=n(5333),m=n(4757),u=n(8705),d=n(5935),p=n(7616),g=n(396),f=n(3781),h=n(4787);function E(e){const t=e.match(/^([a-zA-Z0-9]+)/);return t?t[1]:e}const b=({query:e,initialStart:t,initialEnd:n,dataSource:b,sourceMetrics:w})=>{const[v]=(0,l.n)(),S=(0,a.useRef)(!1),k=w&&w.length>0;(0,a.useEffect)(()=>{S.current||(S.current=!0,(0,d.z)("exposed_component_viewed",{component:"knowledge_graph_source_metrics"}))},[]);const y=(0,f.$9)(e);let _,R;if(k)R=w[0].labels.map(e=>(0,g.Do)(e));else{if(!y){const t=new Error("Missing metric information for Knowledge Graph insight");return u.v.error(t,{query:e}),o().createElement(c.E,{error:t})}_=y.metric,R=y.labels.map(e=>(0,g.Do)(e))}const C=["asserts","ALERTS"],$=k?function(e){const t=new Set(e.map(E));return Array.from(t)}(w.map(e=>e.metricName)).filter(e=>C.every(t=>!e.startsWith(t))):void 0;if(null==$?void 0:$.length){const e=`${p.mc}-${m.G.prefix}`;r.locationService.partial({[e]:$.join(",")},!0);const t=`${p.mc}-var-${s.NJ}`;r.locationService.partial({[t]:"alphabetical"},!0)}const D=(0,p.ef)({metric:_,initialDS:b.uid,initialFilters:R,$timeRange:(0,h._)(t,n),embedded:!0});return o().createElement("div",{"data-testid":"metrics-drilldown-embedded-label-breakdown"},v?o().createElement(c.E,{error:v}):o().createElement(i.X,{trail:D}))}},4787:(e,t,n)=>{n.d(t,{_:()=>c});var r=n(7781),a=n(3014);function o(e){return"string"==typeof e&&r.dateMath.isMathString(e)?e:r.dateMath.toDateTime(new Date(e),{roundUp:!1}).toISOString()}function c(e,t){return new a.SceneTimeRange({from:o(e),to:o(t)})}},8092:(e,t,n)=>{n.d(t,{BR:()=>o,Hi:()=>c,KF:()=>a});var r=n(5959);const a=(0,n(7616).ef)(),o=(0,r.createContext)({trail:a});function c(){return(0,r.useContext)(o)}},8732:(e,t,n)=>{n.d(t,{S:()=>m,X:()=>l});var r=n(5959),a=n.n(r),o=n(1159),c=n(3498),i=n(8092);const l=(0,r.lazy)(()=>n.e(494).then(n.bind(n,8494))),s=()=>{const e=(0,o.useLocation)();return a().createElement(o.Navigate,{to:`${c.b.Drilldown}${e.search}`,replace:!0})},m=()=>{const{trail:e}=(0,i.Hi)();return a().createElement(o.Routes,null,a().createElement(o.Route,{path:c.b.Drilldown,element:a().createElement(l,{trail:e})}),a().createElement(o.Route,{path:c.b.Trail,element:a().createElement(s,null)}),a().createElement(o.Route,{path:"*",element:a().createElement(o.Navigate,{to:c.b.Drilldown,replace:!0})}))}}}]);
//# sourceMappingURL=768.js.map?_cache=0c7a32587e06d69ff2b1